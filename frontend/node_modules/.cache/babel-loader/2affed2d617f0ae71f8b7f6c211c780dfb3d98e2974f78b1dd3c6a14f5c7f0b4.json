{"ast":null,"code":"import _objectSpread from\"/Volumes/\\u575E\\u57CE/OJ_1/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";//代码提交页面组件：\n//提供表单输入题目 ID、选择语言（Python/C++）、输入代码。\n//提交表单时调用 API 发送代码，展示提交 ID 和结果查询链接。\n//处理加载状态（提交中禁用按钮）。\nimport React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{submitCode}from'../services/api';import'./SubmitPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SubmitPage=()=>{const{problemId}=useParams();const[form,setForm]=useState({problem_id:'',code:'',language:'python'});const[submission,setSubmission]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState('');useEffect(()=>{if(problemId){setForm(prev=>_objectSpread(_objectSpread({},prev),{},{problem_id:Number(problemId)}));}},[problemId]);const handleSubmit=async e=>{e.preventDefault();setLoading(true);setError('');try{const payload=_objectSpread(_objectSpread({},form),{},{problem_id:Number(form.problem_id)});const result=await submitCode(payload);setSubmission(result);console.log('提交成功:',result);}catch(error){var _error$response,_error$response$data;console.error('提交失败:',error);setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'提交失败，请重试');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"submit-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u63D0\\u4EA4\\u4EE3\\u7801\"}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[\"\\u26A0\\uFE0F \",error]}),submission?/*#__PURE__*/_jsxs(\"div\",{className:\"submission-success\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u2705 \\u63D0\\u4EA4\\u6210\\u529F\\uFF01\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"submission-info\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u63D0\\u4EA4ID:\"}),\" \",submission.submission_id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u72B6\\u6001:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"status-pending\",children:submission.status})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u6D88\\u606F:\"}),\" \",submission.message]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"submission-actions\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"/result/\".concat(submission.submission_id),className:\"view-result-btn\",children:\"\\u67E5\\u770B\\u5224\\u9898\\u7ED3\\u679C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSubmission(null);setForm({problem_id:problemId?Number(problemId):'',code:'',language:'python'});setError('');},className:\"submit-again-btn\",children:\"\\u518D\\u6B21\\u63D0\\u4EA4\"})]})]}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"submit-form\",children:[problemId?/*#__PURE__*/_jsxs(\"div\",{className:\"form-group readonly-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u9898\\u76EEID:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"readonly-value\",children:form.problem_id})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u9898\\u76EEID:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:form.problem_id,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{problem_id:e.target.value})),placeholder:\"\\u8BF7\\u8F93\\u5165\\u9898\\u76EEID\",required:true,min:\"1\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u7F16\\u7A0B\\u8BED\\u8A00:\"}),/*#__PURE__*/_jsxs(\"select\",{value:form.language,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{language:e.target.value})),className:\"language-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"python\",children:\"Python\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cpp\",children:\"C++\"}),/*#__PURE__*/_jsx(\"option\",{value:\"java\",children:\"Java\"}),/*#__PURE__*/_jsx(\"option\",{value:\"javascript\",children:\"JavaScript\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u4EE3\\u7801:\"}),/*#__PURE__*/_jsx(\"textarea\",{rows:15,value:form.code,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{code:e.target.value})),placeholder:\"\\u8BF7\\u5728\\u6B64\\u8F93\\u5165\\u60A8\\u7684\\u4EE3\\u7801...\",required:true,className:\"code-textarea\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"submit-btn\",children:loading?'提交中...':'提交代码'})]})]});};export default SubmitPage;","map":{"version":3,"names":["React","useEffect","useState","useParams","submitCode","jsx","_jsx","jsxs","_jsxs","SubmitPage","problemId","form","setForm","problem_id","code","language","submission","setSubmission","loading","setLoading","error","setError","prev","_objectSpread","Number","handleSubmit","e","preventDefault","payload","result","console","log","_error$response","_error$response$data","response","data","className","children","submission_id","status","message","href","concat","onClick","onSubmit","type","value","onChange","target","placeholder","required","min","rows","disabled"],"sources":["/Volumes/坞城/OJ_1/frontend/src/pages/SubmitPage.js"],"sourcesContent":["//代码提交页面组件：\n//提供表单输入题目 ID、选择语言（Python/C++）、输入代码。\n//提交表单时调用 API 发送代码，展示提交 ID 和结果查询链接。\n//处理加载状态（提交中禁用按钮）。\n\nimport React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { submitCode } from '../services/api';\nimport './SubmitPage.css';\n\nconst SubmitPage = () => {\n  const { problemId } = useParams();\n  const [form, setForm] = useState({\n    problem_id: '',\n    code: '',\n    language: 'python'\n  });\n  const [submission, setSubmission] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    if (problemId) {\n      setForm(prev => ({ ...prev, problem_id: Number(problemId) }));\n    }\n  }, [problemId]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    \n    try {\n      const payload = { ...form, problem_id: Number(form.problem_id) };\n      const result = await submitCode(payload);\n      setSubmission(result);\n      console.log('提交成功:', result);\n    } catch (error) {\n      console.error('提交失败:', error);\n      setError(error.response?.data?.error || '提交失败，请重试');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"submit-container\">\n      <h1>提交代码</h1>\n      \n      {error && (\n        <div className=\"error-message\">\n          ⚠️ {error}\n        </div>\n      )}\n      \n      {submission ? (\n        <div className=\"submission-success\">\n          <h2>✅ 提交成功！</h2>\n          <div className=\"submission-info\">\n            <p><strong>提交ID:</strong> {submission.submission_id}</p>\n            <p><strong>状态:</strong> <span className=\"status-pending\">{submission.status}</span></p>\n            <p><strong>消息:</strong> {submission.message}</p>\n          </div>\n          <div className=\"submission-actions\">\n            <a href={`/result/${submission.submission_id}`} className=\"view-result-btn\">\n              查看判题结果\n            </a>\n            <button \n              onClick={() => {\n                setSubmission(null);\n                setForm({ problem_id: problemId ? Number(problemId) : '', code: '', language: 'python' });\n                setError('');\n              }}\n              className=\"submit-again-btn\"\n            >\n              再次提交\n            </button>\n          </div>\n        </div>\n      ) : (\n        <form onSubmit={handleSubmit} className=\"submit-form\">\n          {problemId ? (\n            <div className=\"form-group readonly-field\">\n              <label>题目ID:</label>\n              <div className=\"readonly-value\">{form.problem_id}</div>\n            </div>\n          ) : (\n            <div className=\"form-group\">\n              <label>题目ID:</label>\n              <input \n                type=\"number\" \n                value={form.problem_id}\n                onChange={(e) => setForm({...form, problem_id: e.target.value})}\n                placeholder=\"请输入题目ID\"\n                required\n                min=\"1\"\n              />\n            </div>\n          )}\n          \n          <div className=\"form-group\">\n            <label>编程语言:</label>\n            <select\n              value={form.language}\n              onChange={(e) => setForm({...form, language: e.target.value})}\n              className=\"language-select\"\n            >\n              <option value=\"python\">Python</option>\n              <option value=\"cpp\">C++</option>\n              <option value=\"java\">Java</option>\n              <option value=\"javascript\">JavaScript</option>\n            </select>\n          </div>\n          \n          <div className=\"form-group\">\n            <label>代码:</label>\n            <textarea\n              rows={15}\n              value={form.code}\n              onChange={(e) => setForm({...form, code: e.target.value})}\n              placeholder=\"请在此输入您的代码...\"\n              required\n              className=\"code-textarea\"\n            />\n          </div>\n          \n          <button type=\"submit\" disabled={loading} className=\"submit-btn\">\n            {loading ? '提交中...' : '提交代码'}\n          </button>\n        </form>\n      )}\n    </div>\n  );\n};\n\nexport default SubmitPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}